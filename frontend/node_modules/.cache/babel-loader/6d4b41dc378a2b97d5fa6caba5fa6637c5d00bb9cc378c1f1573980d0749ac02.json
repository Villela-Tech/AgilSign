{"ast":null,"code":"import axios from'axios';const BASE_URL='8.242.76.158';const PORT=443;export const API_URL=`${BASE_URL}:${PORT}`;// URL base do frontend (mesma que a API neste caso)\nexport const FRONTEND_URL=API_URL;export const api=axios.create({baseURL:`${API_URL}/api`,timeout:30000,// 30 segundos\nheaders:{'Content-Type':'application/json','Accept':'application/json'}});// Interceptor para adicionar o token de autenticação\napi.interceptors.request.use(config=>{try{const token=localStorage.getItem('token');if(token&&config.headers){config.headers['Authorization']=`Bearer ${token}`;}console.log('Configuração da requisição:',{url:config.url,method:config.method,headers:config.headers,data:config.data});return config;}catch(error){console.error('Erro ao processar token:',error);return config;}},error=>{console.error('Erro no interceptor de requisição:',error);return Promise.reject(error);});// Interceptor para tratar erros de resposta\napi.interceptors.response.use(response=>{console.log('Resposta recebida:',{status:response.status,data:response.data,headers:response.headers});return response;},error=>{var _error$response,_error$response2,_error$response3;console.error('Erro na resposta:',{message:error.message,response:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data,status:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status,config:error.config});if(((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.status)===401){localStorage.removeItem('token');window.location.href='/';}return Promise.reject(error);});export const TermoService={// Criar novo termo\ncriar:async data=>{try{console.log('Enviando dados para criar termo:',data);console.log('URL da requisição:',`${API_URL}/api/termos`);const response=await api.post('/termos',data);console.log('Resposta completa do servidor:',{status:response.status,headers:response.headers,data:response.data});if(!response.data){throw new Error('Resposta do servidor não contém dados');}if(!response.data.id){throw new Error('Resposta do servidor não contém ID');}return response.data;}catch(error){var _error$response4,_error$response5,_error$response6,_error$response7,_error$response7$data;console.error('Erro detalhado ao criar termo:',{message:error.message,response:(_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.data,status:(_error$response5=error.response)===null||_error$response5===void 0?void 0:_error$response5.status,config:error.config});if(((_error$response6=error.response)===null||_error$response6===void 0?void 0:_error$response6.status)===404){throw new Error('Endpoint não encontrado. Verifique a URL da API.');}if(error.code==='ECONNREFUSED'){throw new Error('Não foi possível conectar ao servidor. Verifique se o servidor está rodando.');}throw new Error(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.message)||error.message||'Erro ao criar termo. Por favor, tente novamente.');}},// Buscar termo por ID\nbuscarPorId:async id=>{const response=await api.get(`/termos/${id}`);return response.data;},// Listar todos os termos\nlistar:async()=>{const response=await api.get('/termos');return response.data;},// Atualizar status do termo\natualizarStatus:async(id,data)=>{const response=await api.patch(`/termos/${id}/status`,data);return response.data;},// Excluir termo\nexcluir:async id=>{await api.delete(`/termos/${id}`);},// Gerar URL de acesso para assinatura\ngerarUrlAcesso(id){return`${API_URL}/assinar/${id}`;},downloadPDF:async id=>{try{const response=await api.get(`/termos/${id}/pdf`,{responseType:'arraybuffer'});return new Blob([response.data],{type:'application/pdf'});}catch(error){console.error('Erro ao baixar PDF:',error);throw error;}},gerarLinkAssinatura:id=>{return`${API_URL}/assinar/${id}`;},gerarLinkVisualizacao:id=>{return`${API_URL}/visualizar/${id}`;}};export default api;","map":{"version":3,"names":["axios","BASE_URL","PORT","API_URL","FRONTEND_URL","api","create","baseURL","timeout","headers","interceptors","request","use","config","token","localStorage","getItem","console","log","url","method","data","error","Promise","reject","response","status","_error$response","_error$response2","_error$response3","message","removeItem","window","location","href","TermoService","criar","post","Error","id","_error$response4","_error$response5","_error$response6","_error$response7","_error$response7$data","code","buscarPorId","get","listar","atualizarStatus","patch","excluir","delete","gerarUrlAcesso","downloadPDF","responseType","Blob","type","gerarLinkAssinatura","gerarLinkVisualizacao"],"sources":["C:/Users/tecnico25/Desktop/agilsign/src/services/api.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst BASE_URL = '8.242.76.158';\r\nconst PORT = 443;\r\nexport const API_URL = `${BASE_URL}:${PORT}`;\r\n\r\n// URL base do frontend (mesma que a API neste caso)\r\nexport const FRONTEND_URL = API_URL;\r\n\r\nexport const api = axios.create({\r\n  baseURL: `${API_URL}/api`,\r\n  timeout: 30000, // 30 segundos\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n    'Accept': 'application/json'\r\n  }\r\n});\r\n\r\n// Interceptor para adicionar o token de autenticação\r\napi.interceptors.request.use((config) => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    if (token && config.headers) {\r\n      config.headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n    console.log('Configuração da requisição:', {\r\n      url: config.url,\r\n      method: config.method,\r\n      headers: config.headers,\r\n      data: config.data\r\n    });\r\n    return config;\r\n  } catch (error) {\r\n    console.error('Erro ao processar token:', error);\r\n    return config;\r\n  }\r\n}, (error) => {\r\n  console.error('Erro no interceptor de requisição:', error);\r\n  return Promise.reject(error);\r\n});\r\n\r\n// Interceptor para tratar erros de resposta\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    console.log('Resposta recebida:', {\r\n      status: response.status,\r\n      data: response.data,\r\n      headers: response.headers\r\n    });\r\n    return response;\r\n  },\r\n  (error) => {\r\n    console.error('Erro na resposta:', {\r\n      message: error.message,\r\n      response: error.response?.data,\r\n      status: error.response?.status,\r\n      config: error.config\r\n    });\r\n    \r\n    if (error.response?.status === 401) {\r\n      localStorage.removeItem('token');\r\n      window.location.href = '/';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport interface TermoData {\r\n  nome: string;\r\n  sobrenome: string;\r\n  email: string;\r\n  equipamento: string;\r\n  equipe: string;\r\n  data: string;\r\n  urlAcesso?: string;\r\n  assinatura?: string;\r\n}\r\n\r\nexport interface TermoResponse {\r\n  id: string;\r\n  urlAcesso: string;\r\n}\r\n\r\nexport interface TermoDetalhes {\r\n  id: string;\r\n  nome: string;\r\n  sobrenome: string;\r\n  email: string;\r\n  equipamento: string;\r\n  status: 'pendente' | 'assinado';\r\n  dataCriacao: string;\r\n  urlAcesso: string;\r\n  assinatura?: string;\r\n}\r\n\r\nexport interface CriarTermoDTO {\r\n  nome: string;\r\n  sobrenome: string;\r\n  email: string;\r\n  equipamento: string;\r\n  status: 'pendente';\r\n}\r\n\r\nexport interface AtualizarStatusDTO {\r\n  status: 'assinado';\r\n  assinatura: string;\r\n}\r\n\r\nexport const TermoService = {\r\n  // Criar novo termo\r\n  criar: async (data: CriarTermoDTO): Promise<TermoDetalhes> => {\r\n    try {\r\n      console.log('Enviando dados para criar termo:', data);\r\n      console.log('URL da requisição:', `${API_URL}/api/termos`);\r\n      \r\n      const response = await api.post<TermoDetalhes>('/termos', data);\r\n      \r\n      console.log('Resposta completa do servidor:', {\r\n        status: response.status,\r\n        headers: response.headers,\r\n        data: response.data\r\n      });\r\n      \r\n      if (!response.data) {\r\n        throw new Error('Resposta do servidor não contém dados');\r\n      }\r\n\r\n      if (!response.data.id) {\r\n        throw new Error('Resposta do servidor não contém ID');\r\n      }\r\n      \r\n      return response.data;\r\n    } catch (error: any) {\r\n      console.error('Erro detalhado ao criar termo:', {\r\n        message: error.message,\r\n        response: error.response?.data,\r\n        status: error.response?.status,\r\n        config: error.config\r\n      });\r\n      \r\n      if (error.response?.status === 404) {\r\n        throw new Error('Endpoint não encontrado. Verifique a URL da API.');\r\n      }\r\n      \r\n      if (error.code === 'ECONNREFUSED') {\r\n        throw new Error('Não foi possível conectar ao servidor. Verifique se o servidor está rodando.');\r\n      }\r\n      \r\n      throw new Error(error.response?.data?.message || error.message || 'Erro ao criar termo. Por favor, tente novamente.');\r\n    }\r\n  },\r\n\r\n  // Buscar termo por ID\r\n  buscarPorId: async (id: string): Promise<TermoDetalhes> => {\r\n    const response = await api.get<TermoDetalhes>(`/termos/${id}`);\r\n    return response.data;\r\n  },\r\n\r\n  // Listar todos os termos\r\n  listar: async (): Promise<TermoDetalhes[]> => {\r\n    const response = await api.get<TermoDetalhes[]>('/termos');\r\n    return response.data;\r\n  },\r\n\r\n  // Atualizar status do termo\r\n  atualizarStatus: async (id: string, data: AtualizarStatusDTO): Promise<TermoDetalhes> => {\r\n    const response = await api.patch<TermoDetalhes>(`/termos/${id}/status`, data);\r\n    return response.data;\r\n  },\r\n\r\n  // Excluir termo\r\n  excluir: async (id: string): Promise<void> => {\r\n    await api.delete(`/termos/${id}`);\r\n  },\r\n\r\n  // Gerar URL de acesso para assinatura\r\n  gerarUrlAcesso(id: string): string {\r\n    return `${API_URL}/assinar/${id}`;\r\n  },\r\n\r\n  downloadPDF: async (id: string): Promise<Blob> => {\r\n    try {\r\n      const response = await api.get(`/termos/${id}/pdf`, {\r\n        responseType: 'arraybuffer'\r\n      });\r\n\r\n      return new Blob([response.data as ArrayBuffer], { type: 'application/pdf' });\r\n    } catch (error) {\r\n      console.error('Erro ao baixar PDF:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  gerarLinkAssinatura: (id: string): string => {\r\n    return `${API_URL}/assinar/${id}`;\r\n  },\r\n\r\n  gerarLinkVisualizacao: (id: string): string => {\r\n    return `${API_URL}/visualizar/${id}`;\r\n  }\r\n};\r\n\r\nexport default api; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}