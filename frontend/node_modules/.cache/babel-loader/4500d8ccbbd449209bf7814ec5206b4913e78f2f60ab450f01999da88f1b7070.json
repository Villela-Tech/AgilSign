{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import{TermoService}from'../services/api';import'./VisualizarTermo.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const VisualizarTermo=()=>{const{id}=useParams();const navigate=useNavigate();const[termo,setTermo]=useState(null);const[loading,setLoading]=useState(true);const[downloading,setDownloading]=useState(false);const[error,setError]=useState(null);useEffect(()=>{const carregarTermo=async()=>{try{if(!id)return;const data=await TermoService.buscarPorId(id);setTermo(data);}catch(err){setError('Erro ao carregar o termo. Por favor, tente novamente.');console.error('Erro ao carregar termo:',err);}finally{setLoading(false);}};carregarTermo();},[id]);const handleDownload=async()=>{if(!termo)return;setDownloading(true);try{const blob=await TermoService.downloadPDF(termo.id);const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`termo-${termo.nome.toLowerCase()}-${termo.id}.pdf`;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);}catch(err){console.error('Erro ao baixar termo:',err);setError('Não foi possível baixar o termo. Por favor, tente novamente.');setTimeout(()=>setError(null),5000);}finally{setDownloading(false);}};const formatarData=data=>{return new Date(data).toLocaleDateString('pt-BR',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit'});};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"visualizar-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Carregando termo...\"})]});}if(error||!termo){return/*#__PURE__*/_jsx(\"div\",{className:\"visualizar-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[error||'Termo não encontrado',/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dashboard'),className:\"voltar-button\",children:\"Voltar ao Dashboard\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"visualizar-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"termo-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"termo-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Termo de Recebimento\"}),/*#__PURE__*/_jsx(\"span\",{className:`status-badge ${termo.status}`,children:termo.status==='pendente'?'Pendente':'Assinado'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"termo-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"termo-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Dados do Recebedor\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Nome:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[termo.nome,\" \",termo.sobrenome]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email:\"}),/*#__PURE__*/_jsx(\"p\",{children:termo.email})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"termo-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Equipamento\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Descri\\xE7\\xE3o:\"}),/*#__PURE__*/_jsx(\"p\",{children:termo.equipamento})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Data de Cria\\xE7\\xE3o:\"}),/*#__PURE__*/_jsx(\"p\",{children:formatarData(termo.dataCriacao)})]})]})]}),termo.status==='assinado'&&/*#__PURE__*/_jsxs(\"div\",{className:\"termo-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Assinatura\"}),/*#__PURE__*/_jsx(\"div\",{className:\"assinatura-preview\",children:/*#__PURE__*/_jsx(\"img\",{src:termo.assinatura,alt:\"Assinatura\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"termo-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dashboard'),className:\"voltar-button\",children:\"Voltar ao Dashboard\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDownload,className:\"download-button\",disabled:termo.status==='pendente'||downloading,children:downloading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner-small\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Baixando...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B07\\uFE0F\"}),\" Baixar Termo\"]})})]})]})});};export default VisualizarTermo;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","TermoService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","VisualizarTermo","id","navigate","termo","setTermo","loading","setLoading","downloading","setDownloading","error","setError","carregarTermo","data","buscarPorId","err","console","handleDownload","blob","downloadPDF","url","window","URL","createObjectURL","a","document","createElement","href","download","nome","toLowerCase","body","appendChild","click","revokeObjectURL","removeChild","setTimeout","formatarData","Date","toLocaleDateString","day","month","year","hour","minute","className","children","onClick","status","sobrenome","email","equipamento","dataCriacao","src","assinatura","alt","disabled"],"sources":["C:/Users/tecnico25/Desktop/agilsign/src/components/VisualizarTermo.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { TermoService, TermoDetalhes } from '../services/api';\r\nimport './VisualizarTermo.css';\r\n\r\nconst VisualizarTermo: React.FC = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [termo, setTermo] = useState<TermoDetalhes | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [downloading, setDownloading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const carregarTermo = async () => {\r\n      try {\r\n        if (!id) return;\r\n        const data = await TermoService.buscarPorId(id);\r\n        setTermo(data);\r\n      } catch (err) {\r\n        setError('Erro ao carregar o termo. Por favor, tente novamente.');\r\n        console.error('Erro ao carregar termo:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    carregarTermo();\r\n  }, [id]);\r\n\r\n  const handleDownload = async () => {\r\n    if (!termo) return;\r\n    \r\n    setDownloading(true);\r\n    try {\r\n      const blob = await TermoService.downloadPDF(termo.id);\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `termo-${termo.nome.toLowerCase()}-${termo.id}.pdf`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n      document.body.removeChild(a);\r\n    } catch (err) {\r\n      console.error('Erro ao baixar termo:', err);\r\n      setError('Não foi possível baixar o termo. Por favor, tente novamente.');\r\n      setTimeout(() => setError(null), 5000);\r\n    } finally {\r\n      setDownloading(false);\r\n    }\r\n  };\r\n\r\n  const formatarData = (data: string) => {\r\n    return new Date(data).toLocaleDateString('pt-BR', {\r\n      day: '2-digit',\r\n      month: '2-digit',\r\n      year: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"visualizar-container\">\r\n        <div className=\"loading-spinner\"></div>\r\n        <p>Carregando termo...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !termo) {\r\n    return (\r\n      <div className=\"visualizar-container\">\r\n        <div className=\"error-message\">\r\n          {error || 'Termo não encontrado'}\r\n          <button onClick={() => navigate('/dashboard')} className=\"voltar-button\">\r\n            Voltar ao Dashboard\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"visualizar-container\">\r\n      <div className=\"termo-card\">\r\n        <div className=\"termo-header\">\r\n          <h2>Termo de Recebimento</h2>\r\n          <span className={`status-badge ${termo.status}`}>\r\n            {termo.status === 'pendente' ? 'Pendente' : 'Assinado'}\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"termo-content\">\r\n          <div className=\"termo-section\">\r\n            <h3>Dados do Recebedor</h3>\r\n            <div className=\"info-grid\">\r\n              <div className=\"info-item\">\r\n                <label>Nome:</label>\r\n                <p>{termo.nome} {termo.sobrenome}</p>\r\n              </div>\r\n              <div className=\"info-item\">\r\n                <label>Email:</label>\r\n                <p>{termo.email}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"termo-section\">\r\n            <h3>Equipamento</h3>\r\n            <div className=\"info-grid\">\r\n              <div className=\"info-item\">\r\n                <label>Descrição:</label>\r\n                <p>{termo.equipamento}</p>\r\n              </div>\r\n              <div className=\"info-item\">\r\n                <label>Data de Criação:</label>\r\n                <p>{formatarData(termo.dataCriacao)}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {termo.status === 'assinado' && (\r\n            <div className=\"termo-section\">\r\n              <h3>Assinatura</h3>\r\n              <div className=\"assinatura-preview\">\r\n                <img src={termo.assinatura} alt=\"Assinatura\" />\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"termo-actions\">\r\n          <button onClick={() => navigate('/dashboard')} className=\"voltar-button\">\r\n            Voltar ao Dashboard\r\n          </button>\r\n          <button \r\n            onClick={handleDownload} \r\n            className=\"download-button\"\r\n            disabled={termo.status === 'pendente' || downloading}\r\n          >\r\n            {downloading ? (\r\n              <>\r\n                <div className=\"loading-spinner-small\"></div>\r\n                <span>Baixando...</span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <span>⬇️</span> Baixar Termo\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualizarTermo; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}