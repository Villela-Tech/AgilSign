Options -MultiViews
RewriteEngine On
RewriteBase /

# API requests should be forwarded to the backend API server
RewriteCond %{REQUEST_URI} ^/api/ [NC]
RewriteRule ^api/(.*)$ https://ville5113.c44.integrator.host/api/$1 [P,L]

# For all other requests that are not files or directories, serve index.html
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.html [QSA,L]

# Force HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://ville5113.c44.integrator.host/$1 [L,R=301]

# Handle Authorization Header
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
  Header set Access-Control-Allow-Headers "X-Requested-With, Content-Type, Authorization"
</IfModule>

# Disable directory browsing
Options -Indexes

# Set cache control for static assets
<FilesMatch "\.(ico|pdf|jpg|jpeg|png|gif|js|css)$">
  Header set Cache-Control "max-age=86400, public"
</FilesMatch>

# Prevent direct access to sensitive files
<FilesMatch "^\.">
  Order allow,deny
  Deny from all
</FilesMatch> 